<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WRUS Portal</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="css/excel.css">
  <link rel="icon" type="image/png" href="images/favicon-32x32.png">
</head>
<body>
  <div class="d-flex flex-column flex-md-row" id="wrapper">
    <div id="sidebarContainer"></div>
    <div class="container-fluid p-2" id="page-content">
      
      <div class="mb-2">
        <h2 class="file-tab-heading">MEMIS to Database</h2>
      </div>

      <!-- Non-Permittees Form-->
      <div class="container my-4">
        <div class="card shadow-sm p-4 border-danger">
          <h5 class="mb-3 text-danger">Import Excel Non-Permittees</h5>

          <div class="row g-3 align-items-center">
            <!-- File input -->
            <div class="col-md-5">
              <label for="excelFileNonPerm" class="form-label fw-semibold">Select Excel File</label>
              <input type="file" class="form-control" id="excelFileNonPerm" accept=".xlsx, .xls" required>
            </div>

            <!-- Year input -->
            <div class="col-md-3">
              <label for="yearConductedNonPerm" class="form-label fw-semibold">Year Inspected</label>
              <input type="number" class="form-control" id="yearConductedNonPerm" placeholder="Enter Year" min="1900" max="2100" required>
            </div>

            <!-- Import button -->
            <div class="col-md-2 d-flex align-items-end">
              <button id="importBtnNonPerm" class="btn btn-danger w-100">
                <i class="bi bi-file-earmark-arrow-up me-1"></i> Import
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Permittees Form-->
      <div class="container my-4">
        <div class="card shadow-sm p-4">
          <h5 class="mb-3">Import Excel Permittees</h5>

          <div class="row g-3 align-items-center">
            <!-- File input -->
            <div class="col-md-5">
              <label for="excelFile" class="form-label fw-semibold">Select Excel File</label>
              <input type="file" class="form-control" id="excelFile" accept=".xlsx, .xls" required>
            </div>

            <!-- Year input -->
            <div class="col-md-3">
              <label for="yearConducted" class="form-label fw-semibold">Year Inspected</label>
              <input type="number" class="form-control" id="yearConducted" placeholder="Enter Year" min="1900" max="2100" required>
            </div>

            <!-- Import button -->
            <div class="col-md-2 d-flex align-items-end">
              <button id="importBtn" class="btn btn-primary w-100">
                <i class="bi bi-file-earmark-excel me-1"></i> Import
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Import Progress Log -->
      <div id="importLogContainer" class="mt-4 d-none">
        <div class="card">
          <div class="card-header bg-primary text-white d-flex align-items-center justify-content-between">
            <span>Import Progress</span>
            <span class="small text-warning fw-bold" id="importWarning">
              ⚠️ Do not close or refresh this page
            </span>
          </div>
          <div class="card-body">
            
            <!-- Loader -->
            <div id="importLoader" class="d-none text-center mb-3">
              <div class="import-progress-circle"></div>
              <div class="text-secondary small mt-2">Processing... Please wait</div>
            </div>

            <!-- Log output -->
            <div id="importLog" class="bg-light border p-2"
                style="height: 200px; overflow-y: auto; font-family: monospace;">
              <!-- Logs will appear here -->
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script type="module" src="./js/excel/excel-init.js"></script>
  <!-- <script type="module" src="firestore-functions.js"></script> -->
</body>
</html>